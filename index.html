<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>libhoney API documentation</title>
    <meta name="description" content="libhoney is a library to allow you to send events to Honeycomb from within
your python application.
..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#libhoney.add">add</a></li>
    <li class="mono"><a href="#libhoney.add_dynamic_field">add_dynamic_field</a></li>
    <li class="mono"><a href="#libhoney.add_field">add_field</a></li>
    <li class="mono"><a href="#libhoney.close">close</a></li>
    <li class="mono"><a href="#libhoney.init">init</a></li>
    <li class="mono"><a href="#libhoney.responses">responses</a></li>
    <li class="mono"><a href="#libhoney.send_now">send_now</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#libhoney.Builder">Builder</a></span>
        
          
  <ul>
    <li class="mono"><a href="#libhoney.Builder.__init__">__init__</a></li>
    <li class="mono"><a href="#libhoney.Builder.add">add</a></li>
    <li class="mono"><a href="#libhoney.Builder.add_dynamic_field">add_dynamic_field</a></li>
    <li class="mono"><a href="#libhoney.Builder.add_field">add_field</a></li>
    <li class="mono"><a href="#libhoney.Builder.clone">clone</a></li>
    <li class="mono"><a href="#libhoney.Builder.new_event">new_event</a></li>
    <li class="mono"><a href="#libhoney.Builder.send_now">send_now</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#libhoney.Client">Client</a></span>
        
          
  <ul>
    <li class="mono"><a href="#libhoney.Client.__init__">__init__</a></li>
    <li class="mono"><a href="#libhoney.Client.add">add</a></li>
    <li class="mono"><a href="#libhoney.Client.add_dynamic_field">add_dynamic_field</a></li>
    <li class="mono"><a href="#libhoney.Client.add_field">add_field</a></li>
    <li class="mono"><a href="#libhoney.Client.close">close</a></li>
    <li class="mono"><a href="#libhoney.Client.flush">flush</a></li>
    <li class="mono"><a href="#libhoney.Client.log">log</a></li>
    <li class="mono"><a href="#libhoney.Client.new_builder">new_builder</a></li>
    <li class="mono"><a href="#libhoney.Client.new_event">new_event</a></li>
    <li class="mono"><a href="#libhoney.Client.responses">responses</a></li>
    <li class="mono"><a href="#libhoney.Client.send">send</a></li>
    <li class="mono"><a href="#libhoney.Client.send_dropped_response">send_dropped_response</a></li>
    <li class="mono"><a href="#libhoney.Client.send_now">send_now</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#libhoney.Event">Event</a></span>
        
          
  <ul>
    <li class="mono"><a href="#libhoney.Event.__init__">__init__</a></li>
    <li class="mono"><a href="#libhoney.Event.add">add</a></li>
    <li class="mono"><a href="#libhoney.Event.add_field">add_field</a></li>
    <li class="mono"><a href="#libhoney.Event.add_metadata">add_metadata</a></li>
    <li class="mono"><a href="#libhoney.Event.fields">fields</a></li>
    <li class="mono"><a href="#libhoney.Event.send">send</a></li>
    <li class="mono"><a href="#libhoney.Event.send_presampled">send_presampled</a></li>
    <li class="mono"><a href="#libhoney.Event.timer">timer</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#libhoney.FieldHolder">FieldHolder</a></span>
        
          
  <ul>
    <li class="mono"><a href="#libhoney.FieldHolder.__init__">__init__</a></li>
    <li class="mono"><a href="#libhoney.FieldHolder.add">add</a></li>
    <li class="mono"><a href="#libhoney.FieldHolder.add_dynamic_field">add_dynamic_field</a></li>
    <li class="mono"><a href="#libhoney.FieldHolder.add_field">add_field</a></li>
    <li class="mono"><a href="#libhoney.FieldHolder.is_empty">is_empty</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#libhoney.SendError">SendError</a></span>
        
        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">libhoney</span> module</h1>
  <p>libhoney is a library to allow you to send events to Honeycomb from within
your python application.</p>
<p>Basic usage:</p>
<ul>
<li>initialize libhoney with your Honeycomb writekey and dataset name</li>
<li>create an event object and populate it with fields</li>
<li>send the event object</li>
<li>close libhoney when your program is finished</li>
</ul>
<p>Sending on a closed or uninitialized libhoney will throw a <a href="#libhoney.SendError"><code>SendError</code></a>
exception.</p>
<p>You can find an example demonstrating usage in example.py</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney', this);">Show source &equiv;</a></p>
  <div id="source-libhoney" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;libhoney is a library to allow you to send events to Honeycomb from within</span>
<span class="sd">your python application.</span>

<span class="sd">Basic usage:</span>

<span class="sd">- initialize libhoney with your Honeycomb writekey and dataset name</span>
<span class="sd">- create an event object and populate it with fields</span>
<span class="sd">- send the event object</span>
<span class="sd">- close libhoney when your program is finished</span>

<span class="sd">Sending on a closed or uninitialized libhoney will throw a `libhoney.SendError`</span>
<span class="sd">exception.</span>

<span class="sd">You can find an example demonstrating usage in example.py&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">atexit</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">six.moves.queue</span> <span class="kn">import</span> <span class="n">Queue</span>

<span class="kn">import</span> <span class="nn">libhoney.state</span> <span class="kn">as</span> <span class="nn">state</span>
<span class="kn">from</span> <span class="nn">libhoney.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">libhoney.builder</span> <span class="kn">import</span> <span class="n">Builder</span>
<span class="kn">from</span> <span class="nn">libhoney.event</span> <span class="kn">import</span> <span class="n">Event</span>
<span class="kn">from</span> <span class="nn">libhoney.fields</span> <span class="kn">import</span> <span class="n">FieldHolder</span>
<span class="kn">from</span> <span class="nn">libhoney.errors</span> <span class="kn">import</span> <span class="n">SendError</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="n">writekey</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">api_host</span><span class="o">=</span><span class="s2">&quot;https://api.honeycomb.io&quot;</span><span class="p">,</span> <span class="n">max_concurrent_batches</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
         <span class="n">max_batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">send_frequency</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
         <span class="n">block_on_send</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">block_on_response</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">transmission_impl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
         <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Initialize libhoney and prepare it to send events to Honeycomb. This creates</span>
<span class="sd">    a global Client object that is configured with the supplied parameters. For some</span>
<span class="sd">    advanced used cases, you might consider creating a Client object directly, but</span>
<span class="sd">    `init` is the quickest path to getting data into Honeycomb.</span>

<span class="sd">    Note that libhoney initialization initializes a number of threads to handle</span>
<span class="sd">    sending payloads to Honeycomb. Be mindful of where you&#39;re calling</span>
<span class="sd">    `libhoney.init()` in order to ensure correct enqueueing + processing of</span>
<span class="sd">    events on the spawned threads.</span>

<span class="sd">    Args:</span>

<span class="sd">    - `writekey`: the authorization key for your team on Honeycomb. Find your team</span>
<span class="sd">            write key at [https://ui.honeycomb.io/account](https://ui.honeycomb.io/account)</span>
<span class="sd">    - `dataset`: the name of the default dataset to which to write</span>
<span class="sd">    - `sample_rate`: the default sample rate. 1 / `sample_rate` events will be sent.</span>
<span class="sd">    - `max_concurrent_batches`: the maximum number of concurrent threads sending events.</span>
<span class="sd">    - `max_batch_size`: the maximum number of events to batch before sendinga.</span>
<span class="sd">    - `send_frequency`: how long to wait before sending a batch of events, in seconds.</span>
<span class="sd">    - `block_on_send`: if true, block when send queue fills. If false, drop</span>
<span class="sd">            events until there&#39;s room in the queue</span>
<span class="sd">    - `block_on_response`: if true, block when the response queue fills. If</span>
<span class="sd">            false, drop response objects.</span>
<span class="sd">    - `transmission_impl`: if set, override the default transmission implementation (for example, TornadoTransmission)</span>

<span class="sd">    --------</span>

<span class="sd">    **Configuration recommendations**:</span>

<span class="sd">    **For gunicorn**, use a [`post_worker_init` config hook](http://docs.gunicorn.org/en/stable/settings.html#post-worker-init) to initialize Honeycomb:</span>

<span class="sd">        # conf.py</span>
<span class="sd">        import logging</span>
<span class="sd">        import os</span>

<span class="sd">        def post_worker_init(worker):</span>
<span class="sd">            logging.info(f&#39;libhoney initialization in process pid {os.getpid()}&#39;)</span>
<span class="sd">            libhoney.init(writekey=&quot;YOUR_WRITE_KEY&quot;, dataset=&quot;dataset_name&quot;)</span>

<span class="sd">    Then start gunicorn with the `-c` option:</span>

<span class="sd">        gunicorn -c /path/to/conf.py</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span>
        <span class="n">writekey</span><span class="o">=</span><span class="n">writekey</span><span class="p">,</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span>
        <span class="n">api_host</span><span class="o">=</span><span class="n">api_host</span><span class="p">,</span>
        <span class="n">max_concurrent_batches</span><span class="o">=</span><span class="n">max_concurrent_batches</span><span class="p">,</span>
        <span class="n">max_batch_size</span><span class="o">=</span><span class="n">max_batch_size</span><span class="p">,</span>
        <span class="n">send_frequency</span><span class="o">=</span><span class="n">send_frequency</span><span class="p">,</span>
        <span class="n">block_on_send</span><span class="o">=</span><span class="n">block_on_send</span><span class="p">,</span>
        <span class="n">block_on_response</span><span class="o">=</span><span class="n">block_on_response</span><span class="p">,</span>
        <span class="n">transmission_impl</span><span class="o">=</span><span class="n">transmission_impl</span><span class="p">,</span>
        <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">responses</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Returns a queue from which you can read a record of response info from</span>
<span class="sd">    each event sent by the global client. Responses will be dicts with the</span>
<span class="sd">    following keys:</span>

<span class="sd">    - `status_code` - the HTTP response from the api (eg. 200 or 503)</span>
<span class="sd">    - `duration` - how long it took to POST this event to the api, in ms</span>
<span class="sd">    - `metadata` - pass through the metadata you added on the initial event</span>
<span class="sd">    - `body` - the content returned by API (will be empty on success)</span>
<span class="sd">    - `error` - in an error condition, this is filled with the error message</span>

<span class="sd">    When a None object appears on the queue the reader should exit&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="c1"># return an empty queue rather than None. While not ideal, it is</span>
        <span class="c1"># better than returning None and introducing AttributeErrors into</span>
        <span class="c1"># the caller&#39;s code</span>
        <span class="k">return</span> <span class="n">Queue</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">responses</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add a field to the global client. This field will be sent with every event.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add a dynamic field to the global client. This function will be executed every time an</span>
<span class="sd">       event is created. The key/value pair of the function&#39;s name and its</span>
<span class="sd">       return value will be sent with every event.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add takes a mappable object and adds each key/value pair to the global client.</span>
<span class="sd">    These key/value pairs will be sent with every event created by the global client.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">new_event</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&#39;&#39;&#39; Creates a new event with the global client. If libhoney has not been</span>
<span class="sd">    initialized, sending this event will be a no-op.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">Event</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">send_now</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    DEPRECATED - This will likely be removed in a future major version.</span>

<span class="sd">    Creates an event with the data passed in and enqueues it to be sent.</span>
<span class="sd">    Contrary to the name, it does not block the application when called.</span>

<span class="sd">    Shorthand for:</span>

<span class="sd">        ev = libhoney.Event()</span>
<span class="sd">        ev.add(data)</span>
<span class="sd">        ev.send()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">ev</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="p">)</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">flush</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Closes and restarts the transmission, sending all enqueued events </span>
<span class="sd">    created by the global client. Use this if you want to perform a blocking </span>
<span class="sd">    send of all events in your application.</span>

<span class="sd">    Note: does not work with asynchronous Transmission implementations such</span>
<span class="sd">    as TornadoTransmission.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">close</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Wait for in-flight events to be transmitted then shut down cleanly.</span>
<span class="sd">       Optional (will be called automatically at exit) unless your</span>
<span class="sd">       application is consuming from the responses queue and needs to know</span>
<span class="sd">       when all responses have been received.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># we should error on post-close sends</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">close</span><span class="p">)</span> <span class="c1"># safe because it&#39;s a no-op unless init() was called</span>

<span class="c1"># export everything</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Builder&quot;</span><span class="p">,</span> <span class="s2">&quot;Event&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="s2">&quot;FieldHolder&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SendError&quot;</span><span class="p">,</span> <span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;add_dynamic_field&quot;</span><span class="p">,</span>
    <span class="s2">&quot;add_field&quot;</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">,</span> <span class="s2">&quot;init&quot;</span><span class="p">,</span> <span class="s2">&quot;responses&quot;</span><span class="p">,</span> <span class="s2">&quot;send_now&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="libhoney.add">
    <p>def <span class="ident">add</span>(</p><p>data)</p>
    </div>
    

    
  
    <div class="desc"><p>Add takes a mappable object and adds each key/value pair to the global client.
These key/value pairs will be sent with every event created by the global client.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.add', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add takes a mappable object and adds each key/value pair to the global client.</span>
<span class="sd">    These key/value pairs will be sent with every event created by the global client.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="libhoney.add_dynamic_field">
    <p>def <span class="ident">add_dynamic_field</span>(</p><p>fn)</p>
    </div>
    

    
  
    <div class="desc"><p>Add a dynamic field to the global client. This function will be executed every time an
event is created. The key/value pair of the function's name and its
return value will be sent with every event.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.add_dynamic_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.add_dynamic_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add a dynamic field to the global client. This function will be executed every time an</span>
<span class="sd">       event is created. The key/value pair of the function&#39;s name and its</span>
<span class="sd">       return value will be sent with every event.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="libhoney.add_field">
    <p>def <span class="ident">add_field</span>(</p><p>name, val)</p>
    </div>
    

    
  
    <div class="desc"><p>Add a field to the global client. This field will be sent with every event.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.add_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.add_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add a field to the global client. This field will be sent with every event.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="libhoney.close">
    <p>def <span class="ident">close</span>(</p><p>)</p>
    </div>
    

    
  
    <div class="desc"><p>Wait for in-flight events to be transmitted then shut down cleanly.
Optional (will be called automatically at exit) unless your
application is consuming from the responses queue and needs to know
when all responses have been received.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.close', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.close" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">close</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Wait for in-flight events to be transmitted then shut down cleanly.</span>
<span class="sd">       Optional (will be called automatically at exit) unless your</span>
<span class="sd">       application is consuming from the responses queue and needs to know</span>
<span class="sd">       when all responses have been received.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># we should error on post-close sends</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="libhoney.init">
    <p>def <span class="ident">init</span>(</p><p>writekey=&#39;&#39;, dataset=&#39;&#39;, sample_rate=1, api_host=&#39;https://api.honeycomb.io&#39;, max_concurrent_batches=10, max_batch_size=100, send_frequency=0.25, block_on_send=False, block_on_response=False, transmission_impl=None, debug=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize libhoney and prepare it to send events to Honeycomb. This creates
a global Client object that is configured with the supplied parameters. For some
advanced used cases, you might consider creating a Client object directly, but
<code>init</code> is the quickest path to getting data into Honeycomb.</p>
<p>Note that libhoney initialization initializes a number of threads to handle
sending payloads to Honeycomb. Be mindful of where you're calling
<code>libhoney.init()</code> in order to ensure correct enqueueing + processing of
events on the spawned threads.</p>
<p>Args:</p>
<ul>
<li><code>writekey</code>: the authorization key for your team on Honeycomb. Find your team
        write key at <a href="https://ui.honeycomb.io/account">https://ui.honeycomb.io/account</a></li>
<li><code>dataset</code>: the name of the default dataset to which to write</li>
<li><code>sample_rate</code>: the default sample rate. 1 / <code>sample_rate</code> events will be sent.</li>
<li><code>max_concurrent_batches</code>: the maximum number of concurrent threads sending events.</li>
<li><code>max_batch_size</code>: the maximum number of events to batch before sendinga.</li>
<li><code>send_frequency</code>: how long to wait before sending a batch of events, in seconds.</li>
<li><code>block_on_send</code>: if true, block when send queue fills. If false, drop
        events until there's room in the queue</li>
<li><code>block_on_response</code>: if true, block when the response queue fills. If
        false, drop response objects.</li>
<li><code>transmission_impl</code>: if set, override the default transmission implementation (for example, TornadoTransmission)</li>
</ul>
<hr />
<p><strong>Configuration recommendations</strong>:</p>
<p><strong>For gunicorn</strong>, use a <a href="http://docs.gunicorn.org/en/stable/settings.html#post-worker-init"><code>post_worker_init</code> config hook</a> to initialize Honeycomb:</p>
<div class="codehilite"><pre><span></span><span class="c1"># conf.py</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">post_worker_init</span><span class="p">(</span><span class="n">worker</span><span class="p">):</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;libhoney initialization in process pid {os.getpid()}&#39;</span><span class="p">)</span>
    <span class="n">libhoney</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">writekey</span><span class="o">=</span><span class="s2">&quot;YOUR_WRITE_KEY&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;dataset_name&quot;</span><span class="p">)</span>
</pre></div>


<p>Then start gunicorn with the <code>-c</code> option:</p>
<div class="codehilite"><pre><span></span>gunicorn -c /path/to/conf.py
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.init', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.init" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="n">writekey</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">api_host</span><span class="o">=</span><span class="s2">&quot;https://api.honeycomb.io&quot;</span><span class="p">,</span> <span class="n">max_concurrent_batches</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
         <span class="n">max_batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">send_frequency</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
         <span class="n">block_on_send</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">block_on_response</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">transmission_impl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
         <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Initialize libhoney and prepare it to send events to Honeycomb. This creates</span>
<span class="sd">    a global Client object that is configured with the supplied parameters. For some</span>
<span class="sd">    advanced used cases, you might consider creating a Client object directly, but</span>
<span class="sd">    `init` is the quickest path to getting data into Honeycomb.</span>

<span class="sd">    Note that libhoney initialization initializes a number of threads to handle</span>
<span class="sd">    sending payloads to Honeycomb. Be mindful of where you&#39;re calling</span>
<span class="sd">    `libhoney.init()` in order to ensure correct enqueueing + processing of</span>
<span class="sd">    events on the spawned threads.</span>

<span class="sd">    Args:</span>

<span class="sd">    - `writekey`: the authorization key for your team on Honeycomb. Find your team</span>
<span class="sd">            write key at [https://ui.honeycomb.io/account](https://ui.honeycomb.io/account)</span>
<span class="sd">    - `dataset`: the name of the default dataset to which to write</span>
<span class="sd">    - `sample_rate`: the default sample rate. 1 / `sample_rate` events will be sent.</span>
<span class="sd">    - `max_concurrent_batches`: the maximum number of concurrent threads sending events.</span>
<span class="sd">    - `max_batch_size`: the maximum number of events to batch before sendinga.</span>
<span class="sd">    - `send_frequency`: how long to wait before sending a batch of events, in seconds.</span>
<span class="sd">    - `block_on_send`: if true, block when send queue fills. If false, drop</span>
<span class="sd">            events until there&#39;s room in the queue</span>
<span class="sd">    - `block_on_response`: if true, block when the response queue fills. If</span>
<span class="sd">            false, drop response objects.</span>
<span class="sd">    - `transmission_impl`: if set, override the default transmission implementation (for example, TornadoTransmission)</span>

<span class="sd">    --------</span>

<span class="sd">    **Configuration recommendations**:</span>

<span class="sd">    **For gunicorn**, use a [`post_worker_init` config hook](http://docs.gunicorn.org/en/stable/settings.html#post-worker-init) to initialize Honeycomb:</span>

<span class="sd">        # conf.py</span>
<span class="sd">        import logging</span>
<span class="sd">        import os</span>

<span class="sd">        def post_worker_init(worker):</span>
<span class="sd">            logging.info(f&#39;libhoney initialization in process pid {os.getpid()}&#39;)</span>
<span class="sd">            libhoney.init(writekey=&quot;YOUR_WRITE_KEY&quot;, dataset=&quot;dataset_name&quot;)</span>

<span class="sd">    Then start gunicorn with the `-c` option:</span>

<span class="sd">        gunicorn -c /path/to/conf.py</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span>
        <span class="n">writekey</span><span class="o">=</span><span class="n">writekey</span><span class="p">,</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span>
        <span class="n">api_host</span><span class="o">=</span><span class="n">api_host</span><span class="p">,</span>
        <span class="n">max_concurrent_batches</span><span class="o">=</span><span class="n">max_concurrent_batches</span><span class="p">,</span>
        <span class="n">max_batch_size</span><span class="o">=</span><span class="n">max_batch_size</span><span class="p">,</span>
        <span class="n">send_frequency</span><span class="o">=</span><span class="n">send_frequency</span><span class="p">,</span>
        <span class="n">block_on_send</span><span class="o">=</span><span class="n">block_on_send</span><span class="p">,</span>
        <span class="n">block_on_response</span><span class="o">=</span><span class="n">block_on_response</span><span class="p">,</span>
        <span class="n">transmission_impl</span><span class="o">=</span><span class="n">transmission_impl</span><span class="p">,</span>
        <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="libhoney.responses">
    <p>def <span class="ident">responses</span>(</p><p>)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a queue from which you can read a record of response info from
each event sent by the global client. Responses will be dicts with the
following keys:</p>
<ul>
<li><code>status_code</code> - the HTTP response from the api (eg. 200 or 503)</li>
<li><code>duration</code> - how long it took to POST this event to the api, in ms</li>
<li><code>metadata</code> - pass through the metadata you added on the initial event</li>
<li><code>body</code> - the content returned by API (will be empty on success)</li>
<li><code>error</code> - in an error condition, this is filled with the error message</li>
</ul>
<p>When a None object appears on the queue the reader should exit</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.responses', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.responses" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">responses</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Returns a queue from which you can read a record of response info from</span>
<span class="sd">    each event sent by the global client. Responses will be dicts with the</span>
<span class="sd">    following keys:</span>

<span class="sd">    - `status_code` - the HTTP response from the api (eg. 200 or 503)</span>
<span class="sd">    - `duration` - how long it took to POST this event to the api, in ms</span>
<span class="sd">    - `metadata` - pass through the metadata you added on the initial event</span>
<span class="sd">    - `body` - the content returned by API (will be empty on success)</span>
<span class="sd">    - `error` - in an error condition, this is filled with the error message</span>

<span class="sd">    When a None object appears on the queue the reader should exit&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="c1"># return an empty queue rather than None. While not ideal, it is</span>
        <span class="c1"># better than returning None and introducing AttributeErrors into</span>
        <span class="c1"># the caller&#39;s code</span>
        <span class="k">return</span> <span class="n">Queue</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="o">.</span><span class="n">responses</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="libhoney.send_now">
    <p>def <span class="ident">send_now</span>(</p><p>data)</p>
    </div>
    

    
  
    <div class="desc"><p>DEPRECATED - This will likely be removed in a future major version.</p>
<p>Creates an event with the data passed in and enqueues it to be sent.
Contrary to the name, it does not block the application when called.</p>
<p>Shorthand for:</p>
<div class="codehilite"><pre><span></span>ev = libhoney.Event()
ev.add(data)
ev.send()
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.send_now', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.send_now" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">send_now</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    DEPRECATED - This will likely be removed in a future major version.</span>

<span class="sd">    Creates an event with the data passed in and enqueues it to be sent.</span>
<span class="sd">    Contrary to the name, it does not block the application when called.</span>

<span class="sd">    Shorthand for:</span>

<span class="sd">        ev = libhoney.Event()</span>
<span class="sd">        ev.add(data)</span>
<span class="sd">        ev.send()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">ev</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span><span class="p">)</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="libhoney.Builder" class="name">class <span class="ident">Builder</span></p>
      
  
    <div class="desc"><p>A Builder is a scoped object to which you can add fields and dynamic
fields. Events created from this builder will inherit all fields
and dynamic fields from this builder and the global environment</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Builder', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Builder" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Builder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;A Builder is a scoped object to which you can add fields and dynamic</span>
<span class="sd">       fields. Events created from this builder will inherit all fields</span>
<span class="sd">       and dynamic fields from this builder and the global environment&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{},</span> <span class="n">dyn_fields</span><span class="o">=</span><span class="p">[],</span> <span class="n">fields</span><span class="o">=</span><span class="n">FieldHolder</span><span class="p">(),</span> <span class="n">client</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># if no client is specified, use the global client if possible</span>
        <span class="k">if</span> <span class="n">client</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">client</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span>

        <span class="c1"># copy configuration from client if possible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">writekey</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">dataset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">api_host</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="s1">&#39;https://api.honeycomb.io&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">=</span> <span class="n">FieldHolder</span><span class="p">()</span>  <span class="c1"># get an empty FH</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">fields</span> <span class="c1"># fill it with the client fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>        <span class="c1"># and anything passed in</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">dyn_fields</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+=</span> <span class="n">fields</span>


    <span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_dynamic_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;`add_dynamic_field` adds a function to the builder. When you create an</span>
<span class="sd">           event from this builder, the function will be executed. The function</span>
<span class="sd">           name is the key and it should return one value.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;add takes a dict-like object and adds each key/value pair to the</span>
<span class="sd">           builder.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_now</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED - This will likely be removed in a future major version.</span>

<span class="sd">        Creates an event with the data passed in and enqueues it to be sent.</span>
<span class="sd">        Contrary to the name, it does not block the application when called.</span>

<span class="sd">        Shorthand for:</span>

<span class="sd">            ev = builder.new_event()</span>
<span class="sd">            ev.add(data)</span>
<span class="sd">            ev.send()</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_event</span><span class="p">()</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">new_event</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;creates a new event from this builder, inheriting all fields and</span>
<span class="sd">           dynamic fields present in the builder&#39;&#39;&#39;</span>
        <span class="n">ev</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">)</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="k">return</span> <span class="n">ev</span>

    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;creates a new builder from this one, creating its own scope to</span>
<span class="sd">           which additional fields and dynamic fields can be added.&#39;&#39;&#39;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Builder</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span>
        <span class="n">c</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span>
        <span class="n">c</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">c</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span>
        <span class="k">return</span> <span class="n">c</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#libhoney.Builder">Builder</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="libhoney.Builder.client" class="name">var <span class="ident">client</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="libhoney.Builder.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, data={}, dyn_fields=[], fields=&lt;libhoney.fields.FieldHolder instance at 0x7f1f88ede368&gt;, client=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Builder.__init__', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Builder.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{},</span> <span class="n">dyn_fields</span><span class="o">=</span><span class="p">[],</span> <span class="n">fields</span><span class="o">=</span><span class="n">FieldHolder</span><span class="p">(),</span> <span class="n">client</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># if no client is specified, use the global client if possible</span>
    <span class="k">if</span> <span class="n">client</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span>
    <span class="c1"># copy configuration from client if possible</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">client</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">writekey</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">api_host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">sample_rate</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="s1">&#39;https://api.honeycomb.io&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">=</span> <span class="n">FieldHolder</span><span class="p">()</span>  <span class="c1"># get an empty FH</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">fields</span> <span class="c1"># fill it with the client fields</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>        <span class="c1"># and anything passed in</span>
    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">dyn_fields</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+=</span> <span class="n">fields</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Builder.add">
    <p>def <span class="ident">add</span>(</p><p>self, data)</p>
    </div>
    

    
  
    <div class="desc"><p>add takes a dict-like object and adds each key/value pair to the
builder.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Builder.add', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Builder.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;add takes a dict-like object and adds each key/value pair to the</span>
<span class="sd">       builder.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Builder.add_dynamic_field">
    <p>def <span class="ident">add_dynamic_field</span>(</p><p>self, fn)</p>
    </div>
    

    
  
    <div class="desc"><p><code>add_dynamic_field</code> adds a function to the builder. When you create an
event from this builder, the function will be executed. The function
name is the key and it should return one value.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Builder.add_dynamic_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Builder.add_dynamic_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_dynamic_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;`add_dynamic_field` adds a function to the builder. When you create an</span>
<span class="sd">       event from this builder, the function will be executed. The function</span>
<span class="sd">       name is the key and it should return one value.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Builder.add_field">
    <p>def <span class="ident">add_field</span>(</p><p>self, name, val)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Builder.add_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Builder.add_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Builder.clone">
    <p>def <span class="ident">clone</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>creates a new builder from this one, creating its own scope to
which additional fields and dynamic fields can be added.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Builder.clone', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Builder.clone" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;creates a new builder from this one, creating its own scope to</span>
<span class="sd">       which additional fields and dynamic fields can be added.&#39;&#39;&#39;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">Builder</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span>
    <span class="n">c</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span>
    <span class="n">c</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
    <span class="n">c</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Builder.new_event">
    <p>def <span class="ident">new_event</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>creates a new event from this builder, inheriting all fields and
dynamic fields present in the builder</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Builder.new_event', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Builder.new_event" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">new_event</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;creates a new event from this builder, inheriting all fields and</span>
<span class="sd">       dynamic fields present in the builder&#39;&#39;&#39;</span>
    <span class="n">ev</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">)</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
    <span class="k">return</span> <span class="n">ev</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Builder.send_now">
    <p>def <span class="ident">send_now</span>(</p><p>self, data)</p>
    </div>
    

    
  
    <div class="desc"><p>DEPRECATED - This will likely be removed in a future major version.</p>
<p>Creates an event with the data passed in and enqueues it to be sent.
Contrary to the name, it does not block the application when called.</p>
<p>Shorthand for:</p>
<div class="codehilite"><pre><span></span>ev = builder.new_event()
ev.add(data)
ev.send()
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Builder.send_now', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Builder.send_now" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">send_now</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    DEPRECATED - This will likely be removed in a future major version.</span>
<span class="sd">    Creates an event with the data passed in and enqueues it to be sent.</span>
<span class="sd">    Contrary to the name, it does not block the application when called.</span>
<span class="sd">    Shorthand for:</span>
<span class="sd">        ev = builder.new_event()</span>
<span class="sd">        ev.add(data)</span>
<span class="sd">        ev.send()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_event</span><span class="p">()</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="libhoney.Client" class="name">class <span class="ident">Client</span></p>
      
  
    <div class="desc"><p>Instantiate a libhoney Client that can prepare and send events to Honeycomb.</p>
<p>Note that libhoney Clients initialize a number of threads to handle
sending payloads to Honeycomb. Client initialization is heavy, and re-use
of Client objects is encouraged. If you must use multiple clients, consider
reducing <code>max_concurrent_batches</code> to reduce the number of threads per client.</p>
<p>When using a Client instance, you need to use the Client to generate Event and Builder
objects. Examples:</p>
<p><code>c = Client(writekey="mywritekey", dataset="mydataset")
ev = c.new_event()
ev.add_field("foo", "bar")
ev.send()</code></p>
<p><code>c = Client(writekey="mywritekey", dataset="mydataset")
b = c.new_builder()
b.add_field("foo", "bar")
ev = b.new_event()
ev.send()</code></p>
<p>To ensure that events are flushed before program termination, you should explicitly call <code>close()</code>
on your Client instance.</p>
<p>Args:</p>
<ul>
<li><code>writekey</code>: the authorization key for your team on Honeycomb. Find your team
        write key at <a href="https://ui.honeycomb.io/account">https://ui.honeycomb.io/account</a></li>
<li><code>dataset</code>: the name of the default dataset to which to write</li>
<li><code>sample_rate</code>: the default sample rate. 1 / <code>sample_rate</code> events will be sent.</li>
<li><code>max_concurrent_batches</code>: the maximum number of concurrent threads sending events.</li>
<li><code>max_batch_size</code>: the maximum number of events to batch before sending.</li>
<li><code>send_frequency</code>: how long to wait before sending a batch of events, in seconds.</li>
<li><code>block_on_send</code>: if true, block when send queue fills. If false, drop
        events until there's room in the queue</li>
<li><code>block_on_response</code>: if true, block when the response queue fills. If
        false, drop response objects.</li>
<li><code>transmission_impl</code>: if set, override the default transmission implementation
        (for example, TornadoTransmission)</li>
<li><code>user_agent_addition</code>: if set, its contents will be appended to the
        User-Agent string, separated by a space. The expected format is
        product-name/version, eg "myapp/1.0"</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Instantiate a libhoney Client that can prepare and send events to Honeycomb.</span>

<span class="sd">    Note that libhoney Clients initialize a number of threads to handle</span>
<span class="sd">    sending payloads to Honeycomb. Client initialization is heavy, and re-use</span>
<span class="sd">    of Client objects is encouraged. If you must use multiple clients, consider</span>
<span class="sd">    reducing `max_concurrent_batches` to reduce the number of threads per client.</span>

<span class="sd">    When using a Client instance, you need to use the Client to generate Event and Builder</span>
<span class="sd">    objects. Examples:</span>

<span class="sd">    ```</span>
<span class="sd">    c = Client(writekey=&quot;mywritekey&quot;, dataset=&quot;mydataset&quot;)</span>
<span class="sd">    ev = c.new_event()</span>
<span class="sd">    ev.add_field(&quot;foo&quot;, &quot;bar&quot;)</span>
<span class="sd">    ev.send()</span>
<span class="sd">    ```</span>

<span class="sd">    ```</span>
<span class="sd">    c = Client(writekey=&quot;mywritekey&quot;, dataset=&quot;mydataset&quot;)</span>
<span class="sd">    b = c.new_builder()</span>
<span class="sd">    b.add_field(&quot;foo&quot;, &quot;bar&quot;)</span>
<span class="sd">    ev = b.new_event()</span>
<span class="sd">    ev.send()</span>
<span class="sd">    ```</span>

<span class="sd">    To ensure that events are flushed before program termination, you should explicitly call `close()`</span>
<span class="sd">    on your Client instance.</span>

<span class="sd">    Args:</span>

<span class="sd">    - `writekey`: the authorization key for your team on Honeycomb. Find your team</span>
<span class="sd">            write key at [https://ui.honeycomb.io/account](https://ui.honeycomb.io/account)</span>
<span class="sd">    - `dataset`: the name of the default dataset to which to write</span>
<span class="sd">    - `sample_rate`: the default sample rate. 1 / `sample_rate` events will be sent.</span>
<span class="sd">    - `max_concurrent_batches`: the maximum number of concurrent threads sending events.</span>
<span class="sd">    - `max_batch_size`: the maximum number of events to batch before sending.</span>
<span class="sd">    - `send_frequency`: how long to wait before sending a batch of events, in seconds.</span>
<span class="sd">    - `block_on_send`: if true, block when send queue fills. If false, drop</span>
<span class="sd">            events until there&#39;s room in the queue</span>
<span class="sd">    - `block_on_response`: if true, block when the response queue fills. If</span>
<span class="sd">            false, drop response objects.</span>
<span class="sd">    - `transmission_impl`: if set, override the default transmission implementation</span>
<span class="sd">            (for example, TornadoTransmission)</span>
<span class="sd">    - `user_agent_addition`: if set, its contents will be appended to the</span>
<span class="sd">            User-Agent string, separated by a space. The expected format is</span>
<span class="sd">            product-name/version, eg &quot;myapp/1.0&quot;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writekey</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">api_host</span><span class="o">=</span><span class="s2">&quot;https://api.honeycomb.io&quot;</span><span class="p">,</span>
                 <span class="n">max_concurrent_batches</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">send_frequency</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">block_on_send</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">block_on_response</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">transmission_impl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">user_agent_addition</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="o">=</span> <span class="n">transmission_impl</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="o">=</span> <span class="n">Transmission</span><span class="p">(</span>
                <span class="n">max_concurrent_batches</span><span class="o">=</span><span class="n">max_concurrent_batches</span><span class="p">,</span> <span class="n">block_on_send</span><span class="o">=</span><span class="n">block_on_send</span><span class="p">,</span> <span class="n">block_on_response</span><span class="o">=</span><span class="n">block_on_response</span><span class="p">,</span>
                <span class="n">user_agent_addition</span><span class="o">=</span><span class="n">user_agent_addition</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="n">writekey</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="n">api_host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="n">sample_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">get_response_queue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">block_on_response</span> <span class="o">=</span> <span class="n">block_on_response</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">FieldHolder</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_logger</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;initialized honeycomb client: writekey=</span><span class="si">%s</span><span class="s1"> dataset=</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                 <span class="n">writekey</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">writekey</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;writekey not set! set the writekey if you want to send data to honeycomb&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dataset</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;dataset not set! set a value for dataset if you want to send data to honeycomb&#39;</span><span class="p">)</span>

    <span class="c1"># enable use in a context manager</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tb</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Clean up Transmission if client gets garbage collected&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_init_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">logging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;honeycomb-sdk&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
        <span class="n">ch</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ch</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">responses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a queue from which you can read a record of response info from</span>
<span class="sd">        each event sent. Responses will be dicts with the following keys:</span>

<span class="sd">        - `status_code` - the HTTP response from the api (eg. 200 or 503)</span>
<span class="sd">        - `duration` - how long it took to POST this event to the api, in ms</span>
<span class="sd">        - `metadata` - pass through the metadata you added on the initial event</span>
<span class="sd">        - `body` - the content returned by API (will be empty on success)</span>
<span class="sd">        - `error` - in an error condition, this is filled with the error message</span>

<span class="sd">        When the Client&#39;s `close` method is called, a None will be inserted on</span>
<span class="sd">        the queue, indicating that no further responses will be written.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span>

    <span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;add a global field. This field will be sent with every event.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_dynamic_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;add a global dynamic field. This function will be executed every time an</span>
<span class="sd">        event is created. The key/value pair of the function&#39;s name and its</span>
<span class="sd">        return value will be sent with every event.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;add takes a mappable object and adds each key/value pair to the</span>
<span class="sd">        global scope&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Enqueues the given event to be sent to Honeycomb.</span>

<span class="sd">        Should not be called directly. Instead, use Event:</span>
<span class="sd">            ev = client.new_event()</span>
<span class="sd">            ev.add(data)</span>
<span class="sd">            ev.send()</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                <span class="s2">&quot;tried to send on a closed or uninitialized libhoney client,&quot;</span>
                <span class="s2">&quot; ev = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">fields</span><span class="p">())</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;send enqueuing event ev = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">fields</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_now</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED - This will likely be removed in a future major version.</span>

<span class="sd">        Creates an event with the data passed in and enqueues it to be sent.</span>
<span class="sd">        Contrary to the name, it does not block the application when called.</span>

<span class="sd">        Shorthand for:</span>

<span class="sd">            ev = client.new_event()</span>
<span class="sd">            ev.add(data)</span>
<span class="sd">            ev.send()</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_event</span><span class="p">()</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;send_now enqueuing event ev = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ev</span><span class="o">.</span><span class="n">fields</span><span class="p">())</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">send_dropped_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;push the dropped event down the responses queue&#39;&#39;&#39;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">event</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;event dropped due to sampling&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;enqueuing response = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_on_response</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Full</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Wait for in-flight events to be transmitted then shut down cleanly.</span>
<span class="sd">        Optional (will be called automatically at exit) unless your</span>
<span class="sd">        application is consuming from the responses queue and needs to know</span>
<span class="sd">        when all responses have been received.&#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># we should error on post-close sends</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="o">=</span> <span class="bp">None</span>


    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Closes and restarts the transmission, sending all events. Use this</span>
<span class="sd">        if you want to perform a blocking send of all events in your</span>
<span class="sd">        application.</span>

<span class="sd">        Note: does not work with asynchronous Transmission implementations such</span>
<span class="sd">        as TornadoTransmission.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="p">,</span> <span class="n">Transmission</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">new_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&#39;&#39;&#39;Return an Event, initialized to be sent with this client&#39;&#39;&#39;</span>
        <span class="n">ev</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ev</span>

    <span class="k">def</span> <span class="nf">new_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dyn_fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return a Builder. Events built from this builder will be sent with</span>
<span class="sd">        this client&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">dyn_fields</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dyn_fields</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">FieldHolder</span><span class="p">()</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">Builder</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dyn_fields</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">builder</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#libhoney.Client">Client</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="libhoney.Client.api_host" class="name">var <span class="ident">api_host</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Client.block_on_response" class="name">var <span class="ident">block_on_response</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Client.dataset" class="name">var <span class="ident">dataset</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Client.debug" class="name">var <span class="ident">debug</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Client.fields" class="name">var <span class="ident">fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Client.sample_rate" class="name">var <span class="ident">sample_rate</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Client.writekey" class="name">var <span class="ident">writekey</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Client.xmit" class="name">var <span class="ident">xmit</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="libhoney.Client.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, writekey=&#39;&#39;, dataset=&#39;&#39;, sample_rate=1, api_host=&#39;https://api.honeycomb.io&#39;, max_concurrent_batches=10, max_batch_size=100, send_frequency=0.25, block_on_send=False, block_on_response=False, transmission_impl=None, user_agent_addition=&#39;&#39;, debug=False)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.__init__', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writekey</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">api_host</span><span class="o">=</span><span class="s2">&quot;https://api.honeycomb.io&quot;</span><span class="p">,</span>
             <span class="n">max_concurrent_batches</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
             <span class="n">send_frequency</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">block_on_send</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
             <span class="n">block_on_response</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">transmission_impl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">user_agent_addition</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="o">=</span> <span class="n">transmission_impl</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="o">=</span> <span class="n">Transmission</span><span class="p">(</span>
            <span class="n">max_concurrent_batches</span><span class="o">=</span><span class="n">max_concurrent_batches</span><span class="p">,</span> <span class="n">block_on_send</span><span class="o">=</span><span class="n">block_on_send</span><span class="p">,</span> <span class="n">block_on_response</span><span class="o">=</span><span class="n">block_on_response</span><span class="p">,</span>
            <span class="n">user_agent_addition</span><span class="o">=</span><span class="n">user_agent_addition</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="n">writekey</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="n">api_host</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="n">sample_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">get_response_queue</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">block_on_response</span> <span class="o">=</span> <span class="n">block_on_response</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">FieldHolder</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_logger</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;initialized honeycomb client: writekey=</span><span class="si">%s</span><span class="s1"> dataset=</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
             <span class="n">writekey</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">writekey</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;writekey not set! set the writekey if you want to send data to honeycomb&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">dataset</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;dataset not set! set a value for dataset if you want to send data to honeycomb&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.add">
    <p>def <span class="ident">add</span>(</p><p>self, data)</p>
    </div>
    

    
  
    <div class="desc"><p>add takes a mappable object and adds each key/value pair to the
global scope</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.add', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;add takes a mappable object and adds each key/value pair to the</span>
<span class="sd">    global scope&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.add_dynamic_field">
    <p>def <span class="ident">add_dynamic_field</span>(</p><p>self, fn)</p>
    </div>
    

    
  
    <div class="desc"><p>add a global dynamic field. This function will be executed every time an
event is created. The key/value pair of the function's name and its
return value will be sent with every event.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.add_dynamic_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.add_dynamic_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_dynamic_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;add a global dynamic field. This function will be executed every time an</span>
<span class="sd">    event is created. The key/value pair of the function&#39;s name and its</span>
<span class="sd">    return value will be sent with every event.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.add_field">
    <p>def <span class="ident">add_field</span>(</p><p>self, name, val)</p>
    </div>
    

    
  
    <div class="desc"><p>add a global field. This field will be sent with every event.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.add_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.add_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;add a global field. This field will be sent with every event.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.close">
    <p>def <span class="ident">close</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Wait for in-flight events to be transmitted then shut down cleanly.
Optional (will be called automatically at exit) unless your
application is consuming from the responses queue and needs to know
when all responses have been received.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.close', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.close" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Wait for in-flight events to be transmitted then shut down cleanly.</span>
<span class="sd">    Optional (will be called automatically at exit) unless your</span>
<span class="sd">    application is consuming from the responses queue and needs to know</span>
<span class="sd">    when all responses have been received.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c1"># we should error on post-close sends</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.flush">
    <p>def <span class="ident">flush</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Closes and restarts the transmission, sending all events. Use this
if you want to perform a blocking send of all events in your
application.</p>
<p>Note: does not work with asynchronous Transmission implementations such
as TornadoTransmission.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.flush', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.flush" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Closes and restarts the transmission, sending all events. Use this</span>
<span class="sd">    if you want to perform a blocking send of all events in your</span>
<span class="sd">    application.</span>
<span class="sd">    Note: does not work with asynchronous Transmission implementations such</span>
<span class="sd">    as TornadoTransmission.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="p">,</span> <span class="n">Transmission</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.log">
    <p>def <span class="ident">log</span>(</p><p>self, msg, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.log', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.log" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.new_builder">
    <p>def <span class="ident">new_builder</span>(</p><p>self, data=None, dyn_fields=None, fields=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a Builder. Events built from this builder will be sent with
this client</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.new_builder', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.new_builder" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">new_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dyn_fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return a Builder. Events built from this builder will be sent with</span>
<span class="sd">    this client&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">dyn_fields</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">dyn_fields</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">FieldHolder</span><span class="p">()</span>
    <span class="n">builder</span> <span class="o">=</span> <span class="n">Builder</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dyn_fields</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">builder</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.new_event">
    <p>def <span class="ident">new_event</span>(</p><p>self, data={})</p>
    </div>
    

    
  
    <div class="desc"><p>Return an Event, initialized to be sent with this client</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.new_event', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.new_event" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">new_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&#39;&#39;&#39;Return an Event, initialized to be sent with this client&#39;&#39;&#39;</span>
    <span class="n">ev</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ev</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.responses">
    <p>def <span class="ident">responses</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a queue from which you can read a record of response info from
each event sent. Responses will be dicts with the following keys:</p>
<ul>
<li><code>status_code</code> - the HTTP response from the api (eg. 200 or 503)</li>
<li><code>duration</code> - how long it took to POST this event to the api, in ms</li>
<li><code>metadata</code> - pass through the metadata you added on the initial event</li>
<li><code>body</code> - the content returned by API (will be empty on success)</li>
<li><code>error</code> - in an error condition, this is filled with the error message</li>
</ul>
<p>When the Client's <code>close</code> method is called, a None will be inserted on
the queue, indicating that no further responses will be written.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.responses', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.responses" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">responses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns a queue from which you can read a record of response info from</span>
<span class="sd">    each event sent. Responses will be dicts with the following keys:</span>
<span class="sd">    - `status_code` - the HTTP response from the api (eg. 200 or 503)</span>
<span class="sd">    - `duration` - how long it took to POST this event to the api, in ms</span>
<span class="sd">    - `metadata` - pass through the metadata you added on the initial event</span>
<span class="sd">    - `body` - the content returned by API (will be empty on success)</span>
<span class="sd">    - `error` - in an error condition, this is filled with the error message</span>
<span class="sd">    When the Client&#39;s `close` method is called, a None will be inserted on</span>
<span class="sd">    the queue, indicating that no further responses will be written.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.send">
    <p>def <span class="ident">send</span>(</p><p>self, event)</p>
    </div>
    

    
  
    <div class="desc"><p>Enqueues the given event to be sent to Honeycomb.</p>
<p>Should not be called directly. Instead, use Event:
    ev = client.new_event()
    ev.add(data)
    ev.send()</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.send', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.send" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Enqueues the given event to be sent to Honeycomb.</span>
<span class="sd">    Should not be called directly. Instead, use Event:</span>
<span class="sd">        ev = client.new_event()</span>
<span class="sd">        ev.add(data)</span>
<span class="sd">        ev.send()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
            <span class="s2">&quot;tried to send on a closed or uninitialized libhoney client,&quot;</span>
            <span class="s2">&quot; ev = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">fields</span><span class="p">())</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;send enqueuing event ev = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">fields</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xmit</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.send_dropped_response">
    <p>def <span class="ident">send_dropped_response</span>(</p><p>self, event)</p>
    </div>
    

    
  
    <div class="desc"><p>push the dropped event down the responses queue</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.send_dropped_response', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.send_dropped_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">send_dropped_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;push the dropped event down the responses queue&#39;&#39;&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">event</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;event dropped due to sampling&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;enqueuing response = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_on_response</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Full</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Client.send_now">
    <p>def <span class="ident">send_now</span>(</p><p>self, data)</p>
    </div>
    

    
  
    <div class="desc"><p>DEPRECATED - This will likely be removed in a future major version.</p>
<p>Creates an event with the data passed in and enqueues it to be sent.
Contrary to the name, it does not block the application when called.</p>
<p>Shorthand for:</p>
<div class="codehilite"><pre><span></span>ev = client.new_event()
ev.add(data)
ev.send()
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Client.send_now', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Client.send_now" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">send_now</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    DEPRECATED - This will likely be removed in a future major version.</span>
<span class="sd">    Creates an event with the data passed in and enqueues it to be sent.</span>
<span class="sd">    Contrary to the name, it does not block the application when called.</span>
<span class="sd">    Shorthand for:</span>
<span class="sd">        ev = client.new_event()</span>
<span class="sd">        ev.add(data)</span>
<span class="sd">        ev.send()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_event</span><span class="p">()</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;send_now enqueuing event ev = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ev</span><span class="o">.</span><span class="n">fields</span><span class="p">())</span>
    <span class="n">ev</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="libhoney.Event" class="name">class <span class="ident">Event</span></p>
      
  
    <div class="desc"><p>An Event is a collection of fields that will be sent to Honeycomb.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;An Event is a collection of fields that will be sent to Honeycomb.&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{},</span> <span class="n">dyn_fields</span><span class="o">=</span><span class="p">[],</span> <span class="n">fields</span><span class="o">=</span><span class="n">FieldHolder</span><span class="p">(),</span> <span class="n">client</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">client</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">client</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span>

        <span class="c1"># copy configuration from client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">writekey</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">dataset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">api_host</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="s1">&#39;https://api.honeycomb.io&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># populate the event&#39;s fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">=</span> <span class="n">FieldHolder</span><span class="p">()</span>  <span class="c1"># get an empty FH</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">fields</span> <span class="c1"># fill it with the client fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>        <span class="c1"># and anything passed in</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">dyn_fields</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+=</span> <span class="n">fields</span>

        <span class="c1"># fill in other info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">created_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># execute all the dynamic functions and add their data</span>
        <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">_dyn_fields</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">fn</span><span class="p">())</span>


    <span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">md</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Add metadata to an event. This metadata is handed back to you in</span>
<span class="sd">        the response queue. It is not transmitted to Honeycomb; it is a place</span>
<span class="sd">        for you to put identifying information to understand which event a</span>
<span class="sd">        response queue object represents.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">md</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@contextmanager</span>
    <span class="k">def</span> <span class="nf">timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;timer is a context for timing (in milliseconds) a function call.</span>

<span class="sd">        Example:</span>

<span class="sd">            ev = Event()</span>
<span class="sd">            with ev.timer(&quot;database_dur_ms&quot;):</span>
<span class="sd">                do_database_work()</span>

<span class="sd">           will add a field (name, duration) indicating how long it took to run</span>
<span class="sd">           do_database_work()&#39;&#39;&#39;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">yield</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
        <span class="c1"># report in ms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">duration</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;send queues this event for transmission to Honeycomb.</span>

<span class="sd">        Will drop sampled events when sample_rate &gt; 1,</span>
<span class="sd">        and ensure that the Honeycomb datastore correctly considers it</span>
<span class="sd">        as representing `sample_rate` number of similar events.&#39;&#39;&#39;</span>
        <span class="c1"># warn if we&#39;re not using a client instance and global libhoney</span>
        <span class="c1"># is not initialized. This will result in a noop, but is better</span>
        <span class="c1"># than crashing the caller if they forget to initialize</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">_should_drop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">send_dropped_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">send_presampled</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">send_presampled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;send_presampled queues this event for transmission to Honeycomb.</span>

<span class="sd">        Caller is responsible for sampling logic - will not drop any events</span>
<span class="sd">        for sampling. Defining a `sample_rate` will ensure that the Honeycomb</span>
<span class="sd">        datastore correctly considers it as representing `sample_rate` number</span>
<span class="sd">        of similar events.</span>

<span class="sd">        Raises SendError if no fields are defined or critical attributes not</span>
<span class="sd">        set (writekey, dataset, api_host).&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;No metrics added to event. Won&#39;t send empty event.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;No api_host for Honeycomb. Can&#39;t send to the Great Unknown.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;No writekey specified. Can&#39;t send event.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                <span class="s2">&quot;No dataset for Honeycomb. Can&#39;t send event without knowing which dataset it belongs to.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">_data</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#libhoney.Event">Event</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="libhoney.Event.client" class="name">var <span class="ident">client</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Event.created_at" class="name">var <span class="ident">created_at</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.Event.metadata" class="name">var <span class="ident">metadata</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="libhoney.Event.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, data={}, dyn_fields=[], fields=&lt;libhoney.fields.FieldHolder instance at 0x7f1f88ede5f0&gt;, client=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event.__init__', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{},</span> <span class="n">dyn_fields</span><span class="o">=</span><span class="p">[],</span> <span class="n">fields</span><span class="o">=</span><span class="n">FieldHolder</span><span class="p">(),</span> <span class="n">client</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">client</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">G_CLIENT</span>
    <span class="c1"># copy configuration from client</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">client</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">writekey</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">api_host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">sample_rate</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">=</span> <span class="s1">&#39;https://api.honeycomb.io&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># populate the event&#39;s fields</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">=</span> <span class="n">FieldHolder</span><span class="p">()</span>  <span class="c1"># get an empty FH</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">fields</span> <span class="c1"># fill it with the client fields</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>        <span class="c1"># and anything passed in</span>
    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_dynamic_field</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">dyn_fields</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+=</span> <span class="n">fields</span>
    <span class="c1"># fill in other info</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">created_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="c1"># execute all the dynamic functions and add their data</span>
    <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">_dyn_fields</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">fn</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Event.add">
    <p>def <span class="ident">add</span>(</p><p>self, data)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event.add', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Event.add_field">
    <p>def <span class="ident">add_field</span>(</p><p>self, name, val)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event.add_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event.add_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Event.add_metadata">
    <p>def <span class="ident">add_metadata</span>(</p><p>self, md)</p>
    </div>
    

    
  
    <div class="desc"><p>Add metadata to an event. This metadata is handed back to you in
the response queue. It is not transmitted to Honeycomb; it is a place
for you to put identifying information to understand which event a
response queue object represents.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event.add_metadata', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event.add_metadata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">md</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add metadata to an event. This metadata is handed back to you in</span>
<span class="sd">    the response queue. It is not transmitted to Honeycomb; it is a place</span>
<span class="sd">    for you to put identifying information to understand which event a</span>
<span class="sd">    response queue object represents.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">md</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Event.fields">
    <p>def <span class="ident">fields</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event.fields', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event.fields" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">_data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Event.send">
    <p>def <span class="ident">send</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>send queues this event for transmission to Honeycomb.</p>
<p>Will drop sampled events when sample_rate &gt; 1,
and ensure that the Honeycomb datastore correctly considers it
as representing <code>sample_rate</code> number of similar events.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event.send', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event.send" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;send queues this event for transmission to Honeycomb.</span>
<span class="sd">    Will drop sampled events when sample_rate &gt; 1,</span>
<span class="sd">    and ensure that the Honeycomb datastore correctly considers it</span>
<span class="sd">    as representing `sample_rate` number of similar events.&#39;&#39;&#39;</span>
    <span class="c1"># warn if we&#39;re not using a client instance and global libhoney</span>
    <span class="c1"># is not initialized. This will result in a noop, but is better</span>
    <span class="c1"># than crashing the caller if they forget to initialize</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">_should_drop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">send_dropped_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">send_presampled</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Event.send_presampled">
    <p>def <span class="ident">send_presampled</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>send_presampled queues this event for transmission to Honeycomb.</p>
<p>Caller is responsible for sampling logic - will not drop any events
for sampling. Defining a <code>sample_rate</code> will ensure that the Honeycomb
datastore correctly considers it as representing <code>sample_rate</code> number
of similar events.</p>
<p>Raises SendError if no fields are defined or critical attributes not
set (writekey, dataset, api_host).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event.send_presampled', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event.send_presampled" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">send_presampled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;send_presampled queues this event for transmission to Honeycomb.</span>
<span class="sd">    Caller is responsible for sampling logic - will not drop any events</span>
<span class="sd">    for sampling. Defining a `sample_rate` will ensure that the Honeycomb</span>
<span class="sd">    datastore correctly considers it as representing `sample_rate` number</span>
<span class="sd">    of similar events.</span>
<span class="sd">    Raises SendError if no fields are defined or critical attributes not</span>
<span class="sd">    set (writekey, dataset, api_host).&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;No metrics added to event. Won&#39;t send empty event.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_host</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;No api_host for Honeycomb. Can&#39;t send to the Great Unknown.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writekey</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;No writekey specified. Can&#39;t send event.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
            <span class="s2">&quot;No dataset for Honeycomb. Can&#39;t send event without knowing which dataset it belongs to.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">warn_uninitialized</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.Event.timer">
    <p>def <span class="ident">timer</span>(</p><p>*args, **kwds)</p>
    </div>
    

    
  
    <div class="desc"><p>timer is a context for timing (in milliseconds) a function call.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span>ev = Event()
with ev.timer(&quot;database_dur_ms&quot;):
    do_database_work()
</pre></div>


<p>will add a field (name, duration) indicating how long it took to run
   do_database_work()</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.Event.timer', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.Event.timer" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">GeneratorContextManager</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="libhoney.FieldHolder" class="name">class <span class="ident">FieldHolder</span></p>
      
  
    <div class="desc"><p>A FieldHolder is the generalized class that stores fields and dynamic
fields. It should not be used directly; only through the subclasses</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.FieldHolder', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.FieldHolder" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">FieldHolder</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;A FieldHolder is the generalized class that stores fields and dynamic</span>
<span class="sd">       fields. It should not be used directly; only through the subclasses&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dyn_fields</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;adding two field holders merges the data with other overriding</span>
<span class="sd">           any fields they have in common&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dyn_fields</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_dyn_fields</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;two FieldHolders are equal if their datasets are equal&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dyn_fields</span><span class="p">)</span> <span class="o">==</span>
                <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_dyn_fields</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;two FieldHolders are equal if their datasets are equal&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

    <span class="k">def</span> <span class="nf">add_dynamic_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isroutine</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;add_dynamic_field requires function argument&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dyn_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;add requires a dict-like argument&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;returns true if there is no data in this FieldHolder&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;returns a JSON blob of the fields in this holder&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">json_default_handler</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#libhoney.FieldHolder">FieldHolder</a></li>
          </ul>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="libhoney.FieldHolder.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.FieldHolder.__init__', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.FieldHolder.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dyn_fields</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.FieldHolder.add">
    <p>def <span class="ident">add</span>(</p><p>self, data)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.FieldHolder.add', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.FieldHolder.add" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;add requires a dict-like argument&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.FieldHolder.add_dynamic_field">
    <p>def <span class="ident">add_dynamic_field</span>(</p><p>self, fn)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.FieldHolder.add_dynamic_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.FieldHolder.add_dynamic_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_dynamic_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isroutine</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;add_dynamic_field requires function argument&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dyn_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.FieldHolder.add_field">
    <p>def <span class="ident">add_field</span>(</p><p>self, name, val)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.FieldHolder.add_field', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.FieldHolder.add_field" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="libhoney.FieldHolder.is_empty">
    <p>def <span class="ident">is_empty</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>returns true if there is no data in this FieldHolder</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.FieldHolder.is_empty', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.FieldHolder.is_empty" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;returns true if there is no data in this FieldHolder&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="libhoney.SendError" class="name">class <span class="ident">SendError</span></p>
      
  
    <div class="desc"><p>raised when send is called on an event that cannot be sent, such as:
- when it lacks a writekey
- dataset is not specified
- no fields are set</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-libhoney.SendError', this);">Show source &equiv;</a></p>
  <div id="source-libhoney.SendError" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SendError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; raised when send is called on an event that cannot be sent, such as:</span>
<span class="sd">        - when it lacks a writekey</span>
<span class="sd">        - dataset is not specified</span>
<span class="sd">        - no fields are set</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#libhoney.SendError">SendError</a></li>
          <li>exceptions.Exception</li>
          <li>exceptions.BaseException</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="libhoney.SendError.args" class="name">var <span class="ident">args</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="libhoney.SendError.message" class="name">var <span class="ident">message</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
